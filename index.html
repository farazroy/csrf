<!DOCTYPE html>
<html>
<head>
  <title>Same-Origin Cookie Test PoC</title>
</head>
<body>
  <h2>Same-Origin Cookie + Fetch Test</h2>
  <pre id="output">Loading...</pre>

  <script>
    async function test() {
      try {
        // Fetch request to the same origin
        let res = await fetch("/api/test", {
          method: "GET",
          credentials: "include" // Important: sends cookies even HttpOnly
        });

        // Get response headers
        let headers = "";
        for (let [k, v] of res.headers.entries()) {
          headers += k + ": " + v + "\n";
        }

        // Get response body
        let body = await res.text();

        document.getElementById("output").textContent = 
          "=== HEADERS ===\n" + headers + "\n\n=== BODY ===\n" + body;
      } catch (e) {
        document.getElementById("output").textContent = "Error: " + e;
      }
    }

    test();
  </script>
</body>
</html>
